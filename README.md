# epub-ocr-and-translate

### An in-progress set of tools for creating epubs in multiple languages

Scripts to scan a PDF, auto-translate, process, and create epub and PDF output...these scripts are quick and dirty: YMMV, use at your own risk, etc. etc.

**Dependencies:**
- python 2.7
- ImageMagick
- tesseract
- For translation, Google Translate API (with GOOGLE\_APPLICATION\_CREDENTIALS in your env) or [translate-shell](https://github.com/soimort/translate-shell). 
- pandoc
- xetex
- ebook-viewer


### Quick summary:

1. OCR a PDF with `ocr.sh`

    Given a PDF file, OCR and clean it up a little. Requires ImageMagick, tesseract, pdfinfo/pdfseparate. 

2. Translate a file with `trans.py` or `process.sh`

    `trans.py` uses Google's Translate API, which costs $. `process.sh` uses [`translate-shell`](https://github.com/soimort/translate-shell), which is awesome, but you can get blocked by the engines, so it's not great for large texts (but you *can* specify google, bing, yandex). Both output `$source_lang_para \n $dest_lang_para`. 

    **Usage for trans.py:** `python trans.py inputfile.txt two_letter_dest_lang` 
    
    **Usage for process.sh:** `sh process.sh translation_engine source_file output_file`
    
    (`process.sh` is currently hardcoded for ru/en, you can change this and I will fix at some point, but `trans.py`, while it costs $, does work better/faster/more reliably.) 


3. Cut files into individual markdown files for each chapter using **split.py**

   
    **Usage:** 
    
    `python split.py filename.txt CHAPTER` 
    
    (where CHAPTER is the chapter-delimiter; accepts UTF-8, so you can use other languages where necessary. For example, if your source text is Russian, you could use "Глава").

4. Edit markdown output as needed. This is probably the hardest part. Good luck! You may want to skip this and run the other steps to see how much more post-processing work you've got to do. 

5. Build a Makefile that will generate your epub and PDF files from your Markdown source with `makemake.py`

    Creates a make file that will output epub and PDF, gathering all *.md files in the current directory. Requires xetex and pandoc. And ebook-viewer if you want to pop open the output. You should only have to run this once; if you run it again at some point, make sure you've deleted all autogenerated *lang*md files created using step 6.

    **Usage:** `python makemake.py`

6. Create PDF and epub files using `extract.sh`

    **Usage:** `sh extract.sh two_letter_lang`

    `extract.sh` requires `print-lang.py`, which can also be used in standalone mode. It takes a master file that contains two languages, like:

        Это по русски

        This is in English

        Это по русски

        This is in English

    And exports the language you specify. Usage is ``python print-lang.py input_file two_letter_lang_code``
